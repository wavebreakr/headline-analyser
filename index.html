<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Readability Simplifier</title>

<style>
  body {
    font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
    background: #f7f7f7;
    margin: 0;
    padding: 16px;
  }

  .container {
    max-width: 720px;
    margin: auto;
    background: white;
    padding: 16px;
    border-radius: 12px;
    box-shadow: 0 6px 20px rgba(0,0,0,0.06);
  }

  textarea {
    width: 100%;
    min-height: 160px;
    padding: 12px;
    font-size: 16px;
    line-height: 1.5;
    border-radius: 8px;
    border: 1px solid #ccc;
    box-sizing: border-box;
  }

  .controls {
    margin: 16px 0;
  }

  .slider-labels {
    display: flex;
    justify-content: space-between;
    font-size: 14px;
    opacity: 0.7;
  }

  input[type=range] {
    width: 100%;
  }

  button {
    width: 100%;
    padding: 14px;
    font-size: 16px;
    border: none;
    border-radius: 8px;
    background: #111;
    color: white;
    cursor: pointer;
  }

  button:hover {
    background: #333;
  }

  .stats {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
    margin-top: 16px;
    font-size: 14px;
  }

  .stat {
    background: #f1f1f1;
    padding: 10px;
    border-radius: 8px;
  }

  @media (max-width: 600px) {
    .stats {
      grid-template-columns: 1fr;
    }
  }
</style>
</head>

<body>
<div class="container">

<h2>Readability Simplifier</h2>

<textarea id="inputText" placeholder="Paste your text here..."></textarea>

<div class="controls">
  <input type="range" id="strength" min="1" max="3" value="2" />
  <div class="slider-labels">
    <span>Light</span>
    <span>Medium</span>
    <span>Strong</span>
  </div>
</div>

<button onclick="runSimplify()">Simplify</button>

<textarea id="outputText" placeholder="Simplified version appears here..."></textarea>

<div class="stats">
  <div class="stat" id="beforeStats"></div>
  <div class="stat" id="afterStats"></div>
</div>

</div>

<script>
/* ===========================
   MASSIVE REPLACEMENT BANK
=========================== */

const phraseMap = {
  "in order to": "to",
  "prior to": "before",
  "subsequent to": "after",
  "at this point in time": "now",
  "due to the fact that": "because",
  "owing to the fact that": "because",
  "as a result of": "because",
  "with regard to": "about",
  "in relation to": "about",
  "in respect of": "about",
  "commence": "start",
  "commencing": "starting",
  "commenced": "started",
  "utilise": "use",
  "utilising": "using",
  "leverage": "use",
  "endeavour to": "try to",
  "undertake": "do",
  "implement": "use",
  "facilitate": "help",
  "demonstrate": "show",
  "comprehensive": "full",
  "numerous": "many",
  "significant": "big",
  "sufficient": "enough",
  "insufficient": "not enough",
  "optimal": "best",
  "approximately": "about",
  "individuals": "people",
  "organisations": "groups",
  "assistance": "help",
  "prioritise": "focus on",
  "commonly": "often",
  "frequently": "often",
  "initially": "at first",
  "ultimately": "in the end",
  "there is a need to": "we need to",
  "it is important to note that": "",
  "it should be noted that": "",
  "in a manner that": "that",
  "in order for": "so",
  "make use of": "use",
  "provide support to": "help",
  "conduct an evaluation": "review",
  "carry out": "do",
  "has the ability to": "can",
  "has the capacity to": "can"
};

const wordMap = {
  "commencing": "starting",
  "prior": "before",
  "comprehensive": "full",
  "strategically": "carefully",
  "effectively": "well",
  "endeavour": "try",
  "demonstrates": "shows",
  "sustainability": "lasting success",
  "evaluation": "review",
  "optimisation": "improvement",
  "alignment": "fit",
  "initiatives": "plans",
  "resources": "tools",
  "commitment": "care",
  "individual": "person",
  "utilisation": "use",
  "assess": "check",
  "identify": "find",
  "numerous": "many",
  "significantly": "a lot",
  "approximately": "about"
};

/* ===========================
   CORE LOGIC
=========================== */

function runSimplify() {
  const input = document.getElementById("inputText").value;
  const strength = Number(document.getElementById("strength").value);

  const simplified = simplifyText(input, strength);

  document.getElementById("outputText").value = simplified;

  document.getElementById("beforeStats").innerText =
    `Before:\nWords: ${wordCount(input)}\nGrade: ${calculateGrade(input)}`;

  document.getElementById("afterStats").innerText =
    `After:\nWords: ${wordCount(simplified)}\nGrade: ${calculateGrade(simplified)}`;
}

function simplifyText(text, strength) {
  let output = text;

  output = replacePhrases(output);
  output = replaceWords(output, strength);
  output = splitSentences(output, strength);
  output = enforceSentenceLength(output);
  output = cleanPunctuation(output);
  output = capitaliseSentences(output);

  if (strength === 3) {
    let safety = 0;
    while (calculateGrade(output) > 6 && safety < 5) {
      output = replaceWords(output, 3);
      output = enforceSentenceLength(output);
      output = cleanPunctuation(output);
      output = capitaliseSentences(output);
      safety++;
    }
  }

  return output;
}

/* ===========================
   HELPERS
=========================== */

function replacePhrases(text) {
  let result = text.toLowerCase();
  for (const phrase in phraseMap) {
    const regex = new RegExp("\\b" + phrase + "\\b", "gi");
    result = result.replace(regex, phraseMap[phrase]);
  }
  return result;
}

function replaceWords(text, strength) {
  if (strength < 2) return text;

  let result = text;
  for (const word in wordMap) {
    const regex = new RegExp("\\b" + word + "\\b", "gi");
    result = result.replace(regex, wordMap[word]);
  }
  return result;
}

function splitSentences(text, strength) {
  if (strength < 2) return text;

  return text
    .split(/[.!?]/)
    .flatMap(s => s.split(/, and |, but |, which |;|â€”/i))
    .join(". ");
}

function enforceSentenceLength(text) {
  return text.split(".").map(sentence => {
    const words = sentence.trim().split(" ");
    if (words.length <= 12) return sentence.trim();
    let chunks = [];
    while (words.length) chunks.push(words.splice(0, 10).join(" "));
    return chunks.join(". ");
  }).join(". ");
}

function cleanPunctuation(text) {
  return text
    .replace(/\s+/g, " ")
    .replace(/\.+/g, ".")
    .replace(/\s+\./g, ".")
    .trim();
}

function capitaliseSentences(text) {
  return text.replace(/(^\s*[a-z]|[.!?]\s+[a-z])/g, m => m.toUpperCase());
}

/* ===========================
   METRICS
=========================== */

function wordCount(text) {
  return text.trim().split(/\s+/).filter(Boolean).length;
}

function calculateGrade(text) {
  const words = wordCount(text);
  const sentences = Math.max(text.split(/[.!?]/).length - 1, 1);
  const syllables = countSyllables(text);
  return Math.round(0.39 * (words / sentences) + 11.8 * (syllables / words) - 15.59);
}

function countSyllables(text) {
  return text
    .toLowerCase()
    .split(/\s+/)
    .reduce((sum, word) => {
      word = word.replace(/[^a-z]/g, "");
      if (!word) return sum;
      const syllables = word.match(/[aeiouy]{1,2}/g);
      return sum + (syllables ? syllables.length : 1);
    }, 0);
}
</script>
</body>
</html>