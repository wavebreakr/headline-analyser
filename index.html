<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Headline Analyzer — MI-style (final, JSON wordbanks)</title>
<style>
:root{
  --bg:#071017; --card: rgba(255,255,255,0.04); --accent1:#7dd3fc; --accent2:#8c5bff;
  --muted: rgba(255,255,255,0.82); --good:#60e1a1; --warn:#ffd166; --bad:#ff7b7b;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;padding:20px;font-family:-apple-system,BlinkMacSystemFont,"Inter",system-ui,Segoe UI,Roboto,Helvetica,Arial;
  background:linear-gradient(135deg,var(--bg),#0b1830);color:#fff;display:flex;align-items:flex-start;justify-content:center;
}
.container{width:100%;max-width:920px}
.card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:14px;padding:18px;backdrop-filter:blur(12px);box-shadow:0 18px 50px rgba(0,0,0,0.6)}
.header{display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap}
.title{font-weight:800;font-size:18px}
.lead{font-size:13px;color:var(--muted)}
.inputArea{margin-top:12px}
textarea{width:100%;padding:14px;border-radius:12px;border:none;background:rgba(255,255,255,0.03);color:#fff;resize:none;font-size:16px;min-height:84px}
.controls{display:flex;gap:10px;margin-top:12px}
.btn{padding:10px 12px;border-radius:10px;border:none;cursor:pointer;font-weight:800;background:linear-gradient(90deg,var(--accent1),var(--accent2));color:#021}
.btn.alt{background:rgba(255,255,255,0.06);color:#fff}
.grid{display:grid;grid-template-columns:1fr 320px;gap:16px;margin-top:16px}
@media(max-width:860px){ .grid{grid-template-columns:1fr} }
.panel{background:var(--card);padding:12px;border-radius:12px}
.scoreBlock{display:flex;gap:12px;align-items:center}
.scoreNum{font-size:44px;font-weight:900;text-align:center}
.barWrap{flex:1}
.scoreBarBg{height:14px;background:rgba(255,255,255,0.03);border-radius:999px;overflow:hidden}
.scoreBar{height:100%;width:0%;background:linear-gradient(90deg,var(--accent1),var(--accent2));transition:width 850ms cubic-bezier(.2,.9,.2,1);border-radius:999px}
.label{font-weight:800;text-align:center;margin-top:6px}
.breakdown{margin-top:12px;font-size:13px;color:var(--muted)}
.breakdown .row{display:flex;justify-content:space-between;margin-top:8px}
.highlights{margin-top:12px}
.highlight{padding:2px 6px;border-radius:6px}
.hl{background:rgba(255,200,120,0.08)} .hp{background:rgba(150,80,255,0.10)} .he{background:rgba(255,90,130,0.10)} .hs{background:rgba(0,205,255,0.06)} .ha{background:rgba(160,230,160,0.06)}
.footer{margin-top:12px;font-size:12px;color:rgba(255,255,255,0.6);text-align:center}
.small{font-size:13px;color:var(--muted)}
</style>
</head>
<body>
  <div class="container">
    <div class="card" role="main" aria-label="Headline Analyzer">
      <div class="header">
        <div>
          <div class="title">Headline Analyzer — MI-style (final)</div>
          <div class="lead">Paste a headline, click Analyze. Scoring tuned from your dataset; works across any headline.</div>
        </div>
        <div class="lead">Structure-first: formulas, clarity, authority, numbers.</div>
      </div>

      <div class="inputArea">
        <textarea id="headline" placeholder="Type or paste a headline...">Here’s How Fundraisers Want to Be Contacted in 2025 (New Research)</textarea>
        <div class="controls">
          <button id="analyze" class="btn">Analyze</button>
          <button id="clear" class="btn alt">Clear</button>
        </div>
      </div>

      <div class="grid" style="align-items:start">
        <div class="panel">
          <div class="scoreBlock">
            <div style="min-width:120px">
              <div class="scoreNum" id="scoreNum">0</div>
              <div class="label" id="scoreLabel">—</div>
            </div>
            <div class="barWrap">
              <div class="scoreBarBg"><div id="scoreBar" class="scoreBar"></div></div>
              <div class="breakdown" id="breakdown" aria-live="polite"></div>
            </div>
          </div>

          <div class="highlights panel" id="highlightsArea">
            <div style="font-weight:800">Highlights</div>
            <div id="highlights" style="margin-top:8px" class="lead">No highlights yet — analyze a headline.</div>
          </div>
        </div>

        <div class="panel">
          <div style="font-weight:800">Why this score</div>
          <div id="reason" style="margin-top:8px" class="lead">We reward headline formulas (How-to, Here’s How, X Ways), clarity (reader benefit), numbers/years, and authority signals (research, named authors).</div>
          <div style="margin-top:12px;font-weight:800">Matched patterns</div>
          <div id="matched" style="margin-top:8px" class="lead">—</div>
        </div>
      </div>

      <div class="footer">If a headline looks off, paste it here and I’ll tweak the tiniest weights. Want the test harness back? Ask and I’ll add it.</div>
    </div>
  </div>

<script>
/* ===========================
   JSON wordbanks (editable)
   =========================== */

const WORD_BANKS = {
  "power": [
"unlock","boost","dominate","supercharge","ignite","amplify","explode","unleash","skyrocket","crush",
"master","conquer","accelerate","maximize","transform","revolutionize","optimize","surge","charge","turbo",
"fast","free","ultimate","proven","instant","secret","insider","elite","exclusive","breakthrough",
"radical","dominant","powerful","force","unstoppable","major","massive","huge","scale","premium",
"top","best","smash","win","victory","winning","triple","quad","hyper","shock",
"rapid","urgent","dominance","breakout","reveal","revolution","boom","blast","rocket","chargeup",
"premium","legendary","supreme","pioneer","vanguard","bulletproof","ironclad","tested","guaranteed","guarantee",
"certified","secure","precision","laser","swift","flare","flash","blitz","spark","ascend",
"soar","vault","leap","hustle","crushit","dominion","winbig","milestone","monumental","epic",
"iconic","ferocious","fierce","bold","savage","command","control","lead","prevail","thrive",
"prosper","flourish","breakthroughs","unleashed","turbocharge","rapidly","supercharged","ramped","boosted","amplified"
  ],
  "emotional": [
"amazing","incredible","astonishing","heartfelt","uplifting","thrilling","breathtaking","touching","inspiring","joyful",
"passion","delight","stunning","moving","wonderful","magical","surprising","hopeful","wow","compelling",
"relatable","empathic","empathy","proud","grateful","thankful","tender","warm","comforting","soothing",
"energizing","motivating","encouraging","healing","restorative","transformative","emotional","celebratory","nostalgic","sentimental",
"romantic","cheering","uplift","heartwarming","impressive","beautiful","captivating","engaging","memorable","poignant",
"powerful","courageous","brave","honest","real","raw","authentic","sincere","cherished","delightful",
"glowing","radiant","glorious","vibrant","electric","sparkling","blissful","ecstatic","elated","triumphant",
"victorious","groundbreaking","pivotal","defining","seminal","notable","remarkable","noteworthy","staggering","jaw-dropping"
  ],
  "action": [
"learn","discover","get","build","create","grow","save","increase","improve","start",
"master","claim","join","register","download","apply","nominate","vote","submit","explains",
"explain","raised","raise","help","support","engage","connect","share","promote","launch",
"plan","prepare","optimize","test","measure","track","monitor","report","analyze","review",
"execute","deliver","design","develop","train","coach","mentor","guide","steer","drive",
"lead","organize","host","run","manage","scale","expand","bootstrap","fund","fundraise","donate",
"pledge","redeem","convert","activate","enable","unlock","access","subscribe","schedule","finalize",
"complete","claimnow","registernow","downloadnow","applynow","startnow","learnmore","seehow","discoverhow","findout"
  ],
  "uncommon": [
"novel","rare","proprietary","scalable","tactical","strategic","bespoke","holistic","heuristic","heuristics",
"synergy","ecosystem","paradigm","paradigmatic","catalyst","frictionless","granular","micro","macro","iterative",
"agile","lean","deep-dive","playbook","framework","methodology","protocol","ontology","taxonomy","modular",
"plug-and-play","onboarding","retrospective","sprint","backlog","MVP","iteration","scale-up","scaleout","cross-functional",
"multichannel","omnichannel","hyperlocal","hyperfocused","geo-targeted","personalized","segmented","psychographic","demographic","cohort",
"lifecycle","funnel","conversion","engagement","retention","churn","activation","virality","referral","penetration",
"monetize","monetization","sustainability","impact","outcome","quantitative","qualitative","mixed-methods","evidence-based","research-driven",
"benchmarked","validated","replicable","reproducible","audited","compliant","secure","encrypted","serverless","headless",
"decentralized","distributed","blockchain","tokenized","protocols","benchmarks","operational","governance","regulatory","privacy"
  ],
  "trust": [
"proven","verified","trusted","research","report","data","case study","survey","analysis","findings",
"validated","evidence","official","certified","tested","review","expert","expertise","authority","institutional",
"study","whitepaper","paper","journal","peer-reviewed","insights","benchmarks","results","metrics",
"statistics","trends","reporting","audit","evaluation","method","methodology","sample","population","cohort",
"outcomes","impact","success","evidence-based","research-backed","findings","conclusions","interpretation","overview","summary",
"guide","manual","best practice","playbook","toolkit","resources","template","checklist","framework","standards",
"policy","compliance","guidelines","protocols","endorsed","partner","sponsored","supported","backed","fellowship",
"researcher","analyst","professor","study shows","new research","new data","report:" 
  ]
};

/* ===========================
   helpers
   =========================== */
function esc(s){ return String(s||'').replace(/[.*+?^${}()|[\]\\]/g,'\\$&'); }
function wordCount(s){ return String(s||'').trim().split(/\s+/).filter(Boolean).length; }
function charCount(s){ return String(s||'').length; }
function uniqueMatchCount(text, arr){ const t=String(text||'').toLowerCase(); const set=new Set(); arr.forEach(a=>{ const re=new RegExp("\\b"+esc(a)+"\\b","gi"); const m=t.match(re); if(m) set.add(a.toLowerCase()); }); return set.size; }
function occurrenceCount(text, arr){ const t=String(text||'').toLowerCase(); let c=0; arr.forEach(a=>{ const re=new RegExp("\\b"+esc(a)+"\\b","gi"); const m=t.match(re); if(m) c+=m.length; }); return c; }

/* ===========================
   Final scoring engine (tuned)
   =========================== */
/*
 Composition:
 - Base: 50
 - Type (how/guide/new/case/etc): up to 20
 - Benefit clarity: up to 20
 - Numbers: up to 15
 - Emotion/Power: up to 10
 - Structure/length: up to 10
 - Authority/research/named author: up to 12
 - Uniqueness: up to 5
 - CTA strong: +6
 - Penalties: up to -20
*/

function scoreHeadlineFinal(rawIn){
  const raw = String(rawIn||'').trim();
  const lower = raw.toLowerCase();
  const wc = wordCount(raw);
  const cc = charCount(raw);

  const base = 50;
  let score = base;

  // TYPE points (how/guide/new/case/resources)
  let typePoints = 0;
  if (/\b(how to|here('|’)?s how|how)\b/i.test(raw) || /\b(guide|tutorial|playbook|toolkit|cheatsheet|checklist|manual)\b/i.test(lower)) typePoints += 20;
  if (/\b(new|launch|launched|released|introducing|just launched|just announced|release notes)\b/i.test(lower)) typePoints += 14;
  if (/\b(how .* (did|raised|built|won|grew|made)|explains|explained|reveals|case study|interview)\b/i.test(raw)) typePoints += 15;
  if (/\b(resources|best|top|tips|examples)\b/i.test(lower)) typePoints += 8;
  typePoints = Math.min(typePoints, 20);
  score += typePoints;

  // BENEFIT clarity (explicit reader benefit)
  let benefit = 0;
  if (/\b(raise|raise more|win|get|unlock|boost|increase|improve|help you|help your|fundraise|raise money)\b/i.test(lower)) benefit += 16;
  const benefitWords = ["help","tips","guide","improve","raise more","win","boost","increase","better","success","unlock","fast track","free"];
  benefitWords.forEach(bw => { if (new RegExp("\\b"+esc(bw)+"\\b","i").test(lower)) benefit += 2; });
  benefit = Math.min(Math.round(benefit), 20);
  score += benefit;

  // NUMBERS
  let numbers = 0;
  if (/[£$€]\s*\d{1,3}(?:,\d{3})*(\.\d+)?/.test(raw)) numbers += 10;
  if (/\b\d+ ?(million|billion|k|%|\d{4,})\b/i.test(raw)) numbers += 8;
  if (/\b20(2[0-9])\b/.test(raw)) numbers += 5;
  numbers = Math.min(numbers, 15);
  score += numbers;

  // EMOTION / POWER
  const powHits = uniqueMatchCount(lower, WORD_BANKS.power);
  const emoHits = uniqueMatchCount(lower, WORD_BANKS.emotional);
  const emotionPoints = Math.min(10, powHits * 3 + emoHits * 2);
  score += emotionPoints;

  // Structure / length
  let structure = 0;
  if (wc >= 8 && wc <= 14) structure += 10;
  else if (wc >=5 && wc <=18) structure += 6;
  if (/:/.test(raw)) structure += 2;
  if (/\(|\)/.test(raw)) structure += 2;
  structure = Math.min(structure, 10);
  score += structure;

  // Authority / trust / named author
  let authority = 0;
  if (uniqueMatchCount(lower, WORD_BANKS.trust) > 0) authority += 6;
  if (uniqueMatchCount(lower, WORD_BANKS.uncommon) > 0) authority += 2;
  if (/\b[A-Z][a-z]+ [A-Z][a-z]+\b/.test(raw)) authority += 6;
  authority = Math.min(authority, 12);
  score += authority;

  // CTA strong
  if (/\b(apply|nominate|submit|claim|register|join|download|apply now|nominate now|submit now)\b/i.test(lower)) score += 6;

  // Uniqueness small
  const tokens = lower.split(/\s+/).map(t=>t.replace(/[^\w'-]/g,'')).filter(Boolean);
  const uniqRatio = tokens.length ? (new Set(tokens)).size / tokens.length : 0;
  const uniqPoints = uniqRatio >= 0.75 ? 5 : uniqRatio >= 0.6 ? 3 : uniqRatio >= 0.45 ? 1 : 0;
  score += uniqPoints;

  // Penalties
  let penalty = 0;
  if (/\b(insights|stories|updates|news|announcements)\b/i.test(lower) && !/\b(guide|how to|tips|research|report|award|nominations|winners|winner)\b/i.test(lower)) penalty += 6;
  if (/\?\s*$/.test(raw) && !/\b(why|how|what|who)\b/i.test(lower)) penalty += 8;
  if (wc > 20) penalty += 8;
  const yearMatches = raw.match(/\b20(2[0-9])\b/g) || [];
  if (yearMatches.length > 1) penalty += 6;
  const currencyMatches = raw.match(/[£$€]/g) || [];
  if (currencyMatches.length > 1) penalty += 4;
  penalty = Math.min(penalty, 20);
  score -= penalty;

  // Archetype baseline nudging
  const archetype = (/\bhere('|’)?s how\b/i.test(raw) || /^\s*how\b/i.test(raw) || /^\s*\d+\b/.test(raw) || /\b(why you need|why you should|how to)\b/i.test(raw) || /\b(new research|report|study|case study|survey|insights)\b/i.test(lower));
  if (archetype && score < 85) {
    score = Math.min(98, Math.round(Math.max(score, 85 + Math.round((authority + structure) / 6))));
  }

  score = Math.round(Math.max(0, Math.min(100, score)));

  // Label
  let label = "Poor";
  if (score >= 90) label = "Outstanding";
  else if (score >= 80) label = "Great";
  else if (score >= 60) label = "Good";
  else if (score >= 40) label = "Decent";

  // Highlighting
  let highlighted = raw;
  function replaceList(arr, cls){ arr.forEach(w=>{
    const re = new RegExp("\\b"+esc(w)+"\\b","gi");
    highlighted = highlighted.replace(re, m=>`<span class="highlight ${cls}">${m}</span>`);
  });}
  replaceList(WORD_BANKS.trust, 'ha');
  replaceList(WORD_BANKS.power, 'hp');
  replaceList(WORD_BANKS.emotional, 'he');
  replaceList(WORD_BANKS.action, 'hs');

  highlighted = highlighted.replace(/\b(20(2[0-9]))\b/g, '<span class="highlight hl">$1</span>');
  highlighted = highlighted.replace(/\b(how to|here's how|here is how|here('|’)s how|why you need|why you should|how)\b/gi, m=>`<span class="highlight hl">${m}</span>`);
  highlighted = highlighted.replace(/(\(|\))/g, m=>`<span class="highlight hl">${m}</span>`);
  highlighted = highlighted.replace(/:/g, m=>`<span class="highlight hl">${m}</span>`);

  const breakdown = { base, typePoints, benefit, numbers, emotionPoints: emotionPoints || 0, structure, authority, uniqPoints, penalty };
  return { score, label, breakdown, highlighted, matched: { archetype, typePoints, benefit, numbers, emotionPoints, structure, authority, uniqPoints, penalty } };
}

/* ===========================
   UI wiring
   =========================== */
const elHeadline = document.getElementById('headline');
const elAnalyze = document.getElementById('analyze');
const elClear = document.getElementById('clear');
const elScoreNum = document.getElementById('scoreNum');
const elScoreBar = document.getElementById('scoreBar');
const elLabel = document.getElementById('scoreLabel');
const elBreakdown = document.getElementById('breakdown');
const elHighlights = document.getElementById('highlights');
const elMatched = document.getElementById('matched');

function renderResult(res){
  elScoreNum.textContent = res.score;
  elScoreBar.style.width = res.score + "%";
  elLabel.textContent = res.label;

  elBreakdown.innerHTML = `
    <div class="row"><div>Type</div><div>${res.breakdown.typePoints || 0}</div></div>
    <div class="row"><div>Benefit</div><div>${res.breakdown.benefit || 0}</div></div>
    <div class="row"><div>Numbers</div><div>${res.breakdown.numbers || 0}</div></div>
    <div class="row"><div>Emotion</div><div>${res.breakdown.emotionPoints || 0}</div></div>
    <div class="row"><div>Structure</div><div>${res.breakdown.structure || 0}</div></div>
    <div class="row"><div>Authority</div><div>${res.breakdown.authority || 0}</div></div>
    <div class="row"><div>Uniqueness</div><div>${res.breakdown.uniqPoints || 0}</div></div>
    <div class="row"><div>Penalty</div><div>-${res.breakdown.penalty || 0}</div></div>
  `;
  elHighlights.innerHTML = res.highlighted;
  const m = res.matched;
  elMatched.innerHTML = `<div class="small">Archetype: ${m.archetype ? 'Yes' : 'No'} • TypePts ${m.typePoints || 0} • Benefit ${m.benefit || 0}</div>`;
}

elAnalyze.addEventListener('click', ()=>{
  const text = elHeadline.value.trim();
  if (!text) return;
  const out = scoreHeadlineFinal(text);
  renderResult(out);
});

elClear.addEventListener('click', ()=> {
  elHeadline.value = '';
  elScoreNum.textContent = '0';
  elScoreBar.style.width = '0%';
  elLabel.textContent = '—';
  elBreakdown.innerHTML = '';
  elHighlights.innerHTML = 'No highlights yet — analyze a headline.';
  elMatched.innerHTML = '—';
});

/* auto-run sample on load */
window.addEventListener('load', ()=>{
  const sample = elHeadline.value.trim();
  if (sample){
    const out = scoreHeadlineFinal(sample);
    renderResult(out);
  }
});
</script>
</body>
</html>