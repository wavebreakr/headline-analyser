<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Readability Analyzer</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0 auto;
        padding: 20px;
        max-width: 850px;
        line-height: 1.5;
    }
    textarea, .output {
        width: 100%;
        padding: 14px;
        border: 1px solid #ccc;
        border-radius: 6px;
        font-size: 16px;
        box-sizing: border-box;
    }
    textarea {
        min-height: 180px;
        resize: vertical;
    }
    button {
        padding: 10px 16px;
        font-size: 16px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        margin-top: 12px;
    }
    #simplifyBtn { background: #0077ff; color: #fff; }
    .section { margin-top: 24px; }
    .stats span { display: block; margin-bottom: 4px; }
</style>
</head>

<body>

<h2>Readability Analyzer</h2>
<textarea id="inputText" placeholder="Paste or type text here..."></textarea>

<div class="section stats" id="statsBox">
    <strong>Live Readability Stats</strong>
    <span id="grade">Grade Level: —</span>
    <span id="hardWords">Hard Words: —</span>
    <span id="longWordPct">Long Word %: —</span>
    <span id="passive">Passive Voice: —</span>
    <span id="clarity">Clarity Score: —</span>
    <span id="skim">Skimmability: —</span>
</div>

<button id="simplifyBtn">One-Click Simplify</button>

<div class="section">
    <strong>Simplified Text</strong>
    <div class="output" id="outputText"></div>
</div>

<script>
/* -------------------------
   Utility functions
-------------------------- */

function countSyllables(word) {
    word = word.toLowerCase();
    if (word.length <= 3) return 1;
    return (word.match(/[aeiouy]+/g) || []).length;
}

function isPassive(sentence) {
    return /\b(is|are|was|were|be|been|being)\s+\w+ed\b/i.test(sentence);
}

function splitSentences(text) {
    return text.match(/[^.!?]+[.!?]?/g) || [];
}

function getWords(text) {
    return text.toLowerCase().match(/\b[a-zA-Z']+\b/g) || [];
}

/* -------------------------
   Real-Time Analyzer
-------------------------- */

function analyze() {
    const text = document.getElementById("inputText").value.trim();
    if (!text) {
        document.getElementById("grade").textContent = "Grade Level: —";
        document.getElementById("hardWords").textContent = "Hard Words: —";
        document.getElementById("longWordPct").textContent = "Long Word %: —";
        document.getElementById("passive").textContent = "Passive Voice: —";
        document.getElementById("clarity").textContent = "Clarity Score: —";
        document.getElementById("skim").textContent = "Skimmability: —";
        return;
    }

    const sentences = splitSentences(text);
    const words = getWords(text);

    const wordCount = words.length;
    const sentenceCount = sentences.length;

    // Syllables
    const syllables = words.reduce((s, w) => s + countSyllables(w), 0);

    // Hard words (> 3 syllables)
    const hardWords = words.filter(w => countSyllables(w) >= 3).length;

    // Long word percentage (> 7 letters)
    const longWordPct = (words.filter(w => w.length > 7).length / wordCount) * 100;

    // Passive voice
    const passivePct = (sentences.filter(isPassive).length / sentenceCount) * 100;

    // Grade level (FKGL)
    const grade = 0.39 * (wordCount / sentenceCount) + 11.8 * (syllables / wordCount) - 15.59;

    // Clarity score (simple heuristic)
    const clarity = Math.max(0, 100 - (hardWords * 2 + passivePct));

    // Skimmability score
    const skim = Math.max(0, 100 - longWordPct - (grade * 2));

    document.getElementById("grade").textContent = "Grade Level: " + grade.toFixed(1);
    document.getElementById("hardWords").textContent = "Hard Words: " + hardWords;
    document.getElementById("longWordPct").textContent = "Long Word %: " + longWordPct.toFixed(1) + "%";
    document.getElementById("passive").textContent = "Passive Voice: " + passivePct.toFixed(1) + "%";
    document.getElementById("clarity").textContent = "Clarity Score: " + clarity.toFixed(0);
    document.getElementById("skim").textContent = "Skimmability: " + skim.toFixed(0);
}

document.getElementById("inputText").addEventListener("input", analyze);

/* -------------------------
   ONE CLICK SIMPLIFY
-------------------------- */

const dictionary = {
    "utilize": "use",
    "leverage": "use",
    "commence": "start",
    "prioritize": "focus on",
    "approximately": "about",
    "in order to": "to",
    "facilitate": "help",
    "assistance": "help",
    "methodology": "method",
    "comprehensive": "complete",
    "significant": "big",
    "demonstrate": "show",
    "subsequently": "after"
};

function simplifyText(input) {
    let text = input;

    // Replace complex words
    for (const [hard, simple] of Object.entries(dictionary)) {
        const regex = new RegExp("\\b" + hard + "\\b", "gi");
        text = text.replace(regex, simple);
    }

    // Split long sentences
    const sentences = splitSentences(text).flatMap(s => {
        if (s.split(" ").length > 18) {
            return s.split(/,|;/g).map(part => part.trim() + ".");
        }
        return s;
    });

    // Remove filler
    text = sentences.join(" ")
        .replace(/\b(really|very|basically|literally|actually)\b/gi, "")
        .replace(/\s+/g, " ")
        .trim();

    // Fix passive voice (simple attempt)
    text = text.replace(/\bwas (\w+ed)\b/gi, "used to $1");

    return text;
}

document.getElementById("simplifyBtn").addEventListener("click", () => {
    const input = document.getElementById("inputText").value.trim();
    if (!input) return;

    const output = simplifyText(input);
    document.getElementById("outputText").textContent = output;

    // Re-run stats on simplified text
    document.getElementById("inputText").value = output;
    analyze();
});
</script>

</body>
</html>