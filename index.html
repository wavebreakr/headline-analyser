<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Readability Simplifier</title>

<style>
  body {
    font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
    margin: 0;
    padding: 16px;
    background: #f7f7f7;
  }

  h1 {
    font-size: 1.4rem;
    margin-bottom: 8px;
  }

  textarea {
    width: 100%;
    min-height: 160px;
    padding: 12px;
    font-size: 1rem;
    border-radius: 8px;
    border: 1px solid #ccc;
    box-sizing: border-box;
  }

  .controls {
    margin: 16px 0;
  }

  .slider-labels {
    display: flex;
    justify-content: space-between;
    font-size: 0.85rem;
    margin-top: 4px;
    color: #666;
  }

  button {
    width: 100%;
    padding: 14px;
    font-size: 1rem;
    background: #111;
    color: #fff;
    border: none;
    border-radius: 10px;
    cursor: pointer;
  }

  button:active {
    transform: scale(0.99);
  }

  .stats {
    display: flex;
    gap: 12px;
    margin-top: 16px;
    flex-wrap: wrap;
  }

  .stat-box {
    flex: 1;
    background: #fff;
    padding: 12px;
    border-radius: 10px;
    font-size: 0.9rem;
  }

  .result {
    margin-top: 16px;
  }

  .tag {
    display: inline-block;
    margin-left: 6px;
    padding: 2px 8px;
    border-radius: 999px;
    font-size: 0.75rem;
    background: #e0e0e0;
  }
</style>
</head>

<body>

<h1>Make writing clearer</h1>

<textarea id="inputText" placeholder="Paste your text here…"></textarea>

<div class="controls">
  <input type="range" id="strength" min="1" max="3" value="2" />
  <div class="slider-labels">
    <span>Light</span>
    <span>Medium</span>
    <span>Strong</span>
  </div>
</div>

<button onclick="simplify()">Make this clearer</button>

<div class="stats">
  <div class="stat-box" id="beforeStats"></div>
  <div class="stat-box" id="afterStats"></div>
</div>

<div class="result">
  <textarea id="outputText" placeholder="Simplified text appears here…"></textarea>
</div>

<script>
/* ---------- Utilities ---------- */

function wordCount(text) {
  return text.trim().split(/\s+/).filter(Boolean).length;
}

function sentenceSplit(text) {
  return text.split(/(?<=[.!?])\s+/);
}

/* VERY rough grade estimate (intentionally aggressive) */
function readingGrade(text) {
  const words = wordCount(text);
  const sentences = sentenceSplit(text).length || 1;
  const avgWords = words / sentences;
  return Math.max(1, Math.round(avgWords * 0.9));
}

function gradeTag(grade) {
  if (grade <= 6) return "Excellent";
  if (grade <= 9) return "Great";
  if (grade <= 12) return "Good";
  return "Difficult";
}

/* ---------- Simplification Engine ---------- */

const simpleMap = {
  utilize: "use",
  numerous: "many",
  facilitate: "help",
  demonstrate: "show",
  approximately: "about",
  individuals: "people",
  assistance: "help",
  sufficient: "enough",
  purchase: "buy",
  remainder: "rest"
};

function replaceWords(text) {
  let result = text;
  for (const word in simpleMap) {
    const regex = new RegExp(`\\b${word}\\b`, "gi");
    result = result.replace(regex, simpleMap[word]);
  }
  return result;
}

function simplifyText(text, strength) {
  let sentences = sentenceSplit(text);

  if (strength >= 2) {
    sentences = sentences.map(s =>
      s.replace(/, and|, which|, that|;|—/gi, ".")
    );
  }

  if (strength === 3) {
    sentences = sentences.flatMap(s =>
      s.split(/and|but|because|which|that/gi)
    );
  }

  let output = sentences
    .map(s => s.trim())
    .filter(Boolean)
    .join(". ");

  output = replaceWords(output);

  if (!output.endsWith(".")) output += ".";

  return output;
}

/* ---------- Main ---------- */

function simplify() {
  const input = document.getElementById("inputText").value;
  const strength = Number(document.getElementById("strength").value);

  if (!input.trim()) return;

  const beforeGrade = readingGrade(input);
  const beforeWords = wordCount(input);

  const simplified = simplifyText(input, strength);

  const afterGrade = readingGrade(simplified);
  const afterWords = wordCount(simplified);

  document.getElementById("outputText").value = simplified;

  document.getElementById("beforeStats").innerHTML = `
    <strong>Before</strong><br>
    Reading level: Grade ${beforeGrade}
    <span class="tag">${gradeTag(beforeGrade)}</span><br>
    Words: ${beforeWords}
  `;

  document.getElementById("afterStats").innerHTML = `
    <strong>After</strong><br>
    Reading level: Grade ${afterGrade}
    <span class="tag">${gradeTag(afterGrade)}</span><br>
    Words: ${afterWords}
  `;
}
</script>

</body>
</html>